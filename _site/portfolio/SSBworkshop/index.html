<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.18.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>  Phylogenetic Comparative Methods at UH</title>
<meta name="description" content="">


  <meta name="author" content="Rosana Zenil-Ferguson">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Phylogenetic Comparative Methods at UH">
<meta property="og:title" content="">
<meta property="og:url" content="roszenil.github.io/portfolio/SSBworkshop/">




  <meta property="og:image" content="roszenil.github.io/assets/images/sse_files/muhisse2.png">





  <meta property="article:published_time" content="2019-12-29T00:00:00-10:00">






<link rel="canonical" href="roszenil.github.io/portfolio/SSBworkshop/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Rosana Zenil-Ferguson",
      "url": "roszenil.github.io/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Phylogenetic Comparative Methods at UH Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Phylogenetic Comparative Methods at UH
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/people/" >People</a>
            </li><li class="masthead__menu-item">
              <a href="/research/" >Research</a>
            </li><li class="masthead__menu-item">
              <a href="/portfolio/" >Teaching</a>
            </li><li class="masthead__menu-item">
              <a href="/contact/" >Contact</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  











<div class="page__hero--overlay"
  style=" background-image: url('/assets/images/sse_files/muhisse2.png');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          

        
      </h1>
      
        <p class="page__lead">
</p>
      
      
      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/ls2.jpg" alt="Rosana Zenil-Ferguson" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Rosana Zenil-Ferguson</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Assistant Professor. University of Hawai’i</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="https://roszenil.github.io" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> roszenil.github.io</a></li>
          
        
          
            <li><a href="https://twitter.com/roszenil" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> roszenil</a></li>
          
        
          
            <li><a href="https://github.com/roszenil" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> roszenil</a></li>
          
        
      

      

      
        <li>
          <a href="mailto:roszenil@hawaii.edu">
            <meta itemprop="email" content="roszenil@hawaii.edu" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Workshops</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/portfolio/SDD/" class="">SSE models</a></li>
          
            
            

            
            

            <li><a href="/portfolio/SSBworkshop/" class="active">SSE in RevBayes. SSB workshop 2020</a></li>
          
            
            

            
            

            <li><a href="/portfolio/ctmc/" class="">Continuous- Time Markov Chains</a></li>
          
            
            

            
            

            <li><a href="/portfolio/evidence/" class="">Evidential Stats</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2019-12-29T00:00:00-10:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#state-dependent-diversification-models">State dependent diversification models</a>
    <ul>
      <li><a href="#instructors">Instructors</a></li>
      <li><a href="#background">Background</a>
        <ul>
          <li><a href="#introduction-to-bayesian-statistics-and-inference">Introduction to Bayesian Statistics and inference</a></li>
          <li><a href="#introduction-to-continuous-time-markov-chains-ctmc">Introduction to Continuous Time Markov Chains (CTMC)</a></li>
          <li><a href="#basic-installation-of-revbayes-and-software-for-the-workshop">Basic installation of RevBayes and software for the workshop</a></li>
        </ul>
      </li>
      <li><a href="#binary-state-speciation-and-extinction-model-bisse">Binary state speciation and extinction model (BiSSE)</a>
        <ul>
          <li><a href="#bisse-using-revbayes">BiSSE using RevBayes</a></li>
          <li><a href="#full-graphical-bisse-model">Full graphical BiSSE model</a></li>
          <li><a href="#performing-statistical-inference-in-revbayes">Performing statistical inference in RevBayes</a></li>
          <li><a href="#results-visualization">Results visualization</a></li>
        </ul>
      </li>
      <li><a href="#hidden-state-speciation-and-extinction-model-hisse-and-the-character-independent-model">Hidden state speciation and extinction model (HiSSE) and the character independent model</a>
        <ul>
          <li><a href="#key-references">Key References</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <h1 id="state-dependent-diversification-models">State dependent diversification models</h1>
<h2 id="instructors">Instructors</h2>
<ol>
  <li>
    <p><a href="https://carrietribble.weebly.com/">Carrie Tribble</a>
PhD Candidate.
University of California Berkeley.</p>
  </li>
  <li>
    <p><a href="https://caetanods.weebly.com/">Daniel Caetano</a>.
Postdoctoral researcher.
Universidade de São Paulo, Brazil.</p>
  </li>
  <li>
    <p><a href="/contact/">Rosana Zenil-Ferguson</a>
Assistant Professor.
University of Hawai’i Mānoa.</p>
  </li>
</ol>

<h2 id="background">Background</h2>
<p>The goal of this workshop is to get you familiarized with state dependent diversification models. In the literature they are called state dependent speciation and extinction, because the models link the value of the states to the rates of speciation and extinction. This idea will be clearer as we work through the workshop excercises.</p>

<h3 id="introduction-to-bayesian-statistics-and-inference">Introduction to Bayesian Statistics and inference</h3>
<p>For background infromation about some basic Bayesian statistics  and MCMC algorithm to obtain posterior distribution samples plese reafer to the the slides below. This slides are from a short intro workshop I taught in Botany 2018 (Rochester, MN).</p>
<ol>
  <li>Bayesian stats slides <a href="/assets/docs/bayesianstatsintro.pdf">here</a></li>
  <li>Markov chain Monte Carlo (MCMC) slides <a href="/assets/docs/introMCMC.pdf">here</a></li>
</ol>

<p>We really suggest you watch the great introductory lecture from Dr. Paul Lewis available in this <a href="https://www.youtube.com/watch?v=4PWlnNsfz90">video</a>.</p>

<h3 id="introduction-to-continuous-time-markov-chains-ctmc">Introduction to Continuous Time Markov Chains (CTMC)</h3>
<p>Continuous time Markov chains are our power tools when we are trying to model any discrete trait evolution in a phylogeny.  CTMCs are stochastic processes, that is a random variable that we follow throughout time that is measuring the outcome of  interest.</p>

<p>The slides below are from the Botany workshop in 2018</p>
<ol>
  <li>Continuous Time Markov Chains slides <a href="/assets/docs/introCTMC.pdf">here</a></li>
</ol>

<p>but more detailed background information can be found in this long lecture Rosana taught in the <a href="https://phylosdd.github.io/MidwestPhylo2019/">Midwest Phylogenetic Methods Workshop</a> in 2019</p>
<ol>
  <li><a href="https://roszenil.github.io/portfolio/ctmc/">CTMC lecture</a>.</li>
  <li>RevBayes code <a href="/assets/docs/mk2.Rev">mk2.Rev</a></li>
</ol>

<h3 id="basic-installation-of-revbayes-and-software-for-the-workshop">Basic installation of RevBayes and software for the workshop</h3>
<p>In order to make it as efficient as possible the workshop  please follow these steps.</p>
<ol>
  <li>
    <p>Make sure you have access to a command line. For mac users the terminal works fine, for windows users see <a href="https://devblogs.microsoft.com/commandline/introducing-windows-terminal/">this option</a>
If you are not too familiar with the command line check this very <a href="https://tutorial.djangogirls.org/en/intro_to_command_line/">short tutorial</a></p>
  </li>
  <li>
    <p>Install RevBayes try to do it in a folder where you could find easily from the command line <a href="https://revbayes.github.io/download">https://revbayes.github.io/download</a></p>
  </li>
  <li>
    <p>Check that revbayes is well installed in your computer by going through this super <a href="https://revbayes.github.io/tutorials/intro/rev">short tutorial</a></p>
  </li>
  <li>
    <p>Install <a href="http://tree.bio.ed.ac.uk/software/tracer/">Tracer software</a> to check our MCMC output</p>
  </li>
  <li>
    <p>Have R with ggplot and ggtree installed for visualizations</p>
  </li>
</ol>

<h2 id="binary-state-speciation-and-extinction-model-bisse">Binary state speciation and extinction model (BiSSE)</h2>
<p>Carrie Tribble’s lecture slides <a href="/assets/docs/bisse_CarrieTribble.pdf">pdf</a></p>

<p>BiSSE is a stochastic process that is the composition of two different birth-death stochastic processes connected by a transition rate.  The key assumption of a BiSSE model is that the trait can be categorize in two states, each state with its own birth rate <script type="math/tex">\lambda</script> and death rate <script type="math/tex">\mu</script> representing the splitting of a lineage or the extinction of a lineage respectively. This is a big assumption because the implication is that the accumulation (or the lack of) of lineages is link to the value of the state (0 or 1) but nothing else.</p>

<p>Often in the literature, including the original BiSSE article, the model is represented graphically by circles and arrows connected as the figure shown below.</p>

<p><img src="/assets/images/sse_files/bisse.png" alt="" /></p>

<p><em>Figure 1. BiSSE graphical representation in most published papers. Trait is assumed be be binary, parameters <script type="math/tex">(\lambda_0, \lambda_1)</script> are speciation rates link to each of the states, and parameters <script type="math/tex">(\mu_0,\mu_1)</script> are extinction rates. The transition rates <script type="math/tex">(q_{01},q_{10})</script> indicate how often the value of the trait changes.</em></p>

<p>The reason why this model is often represented as “circles and arrows” is because it is much easier to communicate than the mathematical representation.</p>

<h3 id="bisse-using-revbayes">BiSSE using RevBayes</h3>
<p>Another way to think about SSE models that is not only the circle and arrow diagrams, or the stochastic differential equations themselves is the graphical model representation. The goal of this introductory workshop is to get you thinking about graphical representations because you can create custom and more complex models without having to build complex equations every time.</p>

<p>We will discuss some of the caveats as well at the end, but one very important key feature to clarify here is that the graphical model is not only a visual representation, but an alternative to writing the math from the <strong>model and the inference (Bayesian)</strong> simultaneously.</p>

<p><strong>Rev Language</strong></p>

<p>Just a brief reminder that we will be using Rev language and every assignation we use has a meaning in the graphical model world. For more details please refer to (Hoehna et al. 2013 )
<img src="/assets/images/sse_files/revlanguage.png" alt="" />
<em>Figure 2. From Hoehna et al. 2016. Rev language and its graphical model representation</em></p>

<p><strong>Trait data utilized for the workshop</strong>
Polimoneaceae data from Landis, J. et al. 2018. This is a phylogenetic tree of Phlox with selfing and outcrossing data as breeding system binary trait. We will use this dataset as an example of binary trait that could be interesting for diversification.</p>

<p>Trait data <a href="/assets/docs/pole_datadis.csv">.csv</a>, and phylogenetic <a href="/assets/docs/poleult.tre">.tre</a></p>

<p><strong>RevBayes code</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>setOption("useScaling","true")
NUM_STATES = 2
### Read in the data
observed_phylogeny &lt;- readTrees("basicdata/poleult.tre")[1]
data &lt;- readCharacterDataDelimited("basicdata/pole_datadis.csv",
stateLabels=2,
type="NaturalNumbers",
delimiter=",",
headers=TRUE)

# Get some useful variables from the data. For example taxa names in the phylogeny
taxa &lt;- observed_phylogeny.taxa()
### Create the fix parameter for the age of the root set to the observed age
root_age &lt;- observed_phylogeny.rootAge()
</code></pre></div></div>

<p><strong>Indices</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Setting up indices
mvi = 0
mni = 0
</code></pre></div></div>

<p><strong>Speciation and extinction rates</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Create the constant prior parameters of the diversification rates
## Number of surviving lineages is 165

mx=(ln(165/2)/observed_phylogeny.rootAge())
sx= 0.01
rate_mean &lt;- exp(mx+sx^2)
rate_sd &lt;- exp(2*mx+sx^2)*exp(sx^2-1)

for (i in 1:NUM_STATES) {

### Create a lognormal distributed variable for the diversification rate
log_speciation[i] ~ dnNormal(mean=rate_mean,sd=rate_sd)
log_speciation[i].setValue( rate_mean )
speciation[i] := exp( log_speciation[i] )
moves[++mvi] = mvSlide(log_speciation[i],delta=0.20,tune=true,weight=3.0)

### Create a lognormal distributed variable for the turnover rate
log_extinction[i] ~ dnNormal(mean=rate_mean,sd=rate_sd)
log_extinction[i].setValue( rate_mean )
extinction[i] := exp( log_extinction[i] )
moves[++mvi] = mvSlide(log_extinction[i],delta=0.20,tune=true,weight=3)

}
</code></pre></div></div>
<p>In graphical modeling what we are doing is connecting fixed with stochastic nodes that have a log-Normal distribution.</p>

<p><img src="/assets/images/sse_files/gm1.png" alt="" /></p>

<p><em>Figure 3. Graphical modeling of diversification rates of BiSSE. Squares represent deterministic nodes, circles represent stochastic nodes</em></p>

<p><strong>Transition rates</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#########################################################
# Set up the transition rate matrix for observed states #
#########################################################
## I defined very loosely my gamma priors for transition rates
shape_pr := 0.5
rate_pr := 1
############### Alternative definition or rate parameter
# Each transition rate between observed states are drawn
# from an exponential distribution with a mean of 10
# character state transitions over the tree.
# rate_pr := observed_phylogeny.treeLength() / 10

q_01 ~ dnGamma(shape=shape_pr, rate=rate_pr)
q_10 ~ dnGamma(shape=shape_pr, rate=rate_pr)

moves[++mvi] = mvScale( q_01, weight=2 )
moves[++mvi] = mvScale( q_10, weight=2 )

######################################################################
# Create the rate matrix for the combined observed and hidden states #
######################################################################
rate_matrix := fnFreeBinary( [q_01, q_10 ], rescaled=false)

</code></pre></div></div>

<p><img src="/assets/images/sse_files/gm2.png" alt="" /></p>

<p><em>Figure 4. Graphical modeling of transition rates for BiSSE. Squares represent deterministic nodes, circles represent stochastic nodes</em></p>

<p><strong>What are the moves?</strong>
 There are many many <a href="https://revbayes.github.io/documentation/">moves</a> available in RevBayes, some specific for certain types of inferences and some others very general.</p>

<p><strong>Treatment of the root</strong></p>

<p>Prior distribution for the root that is <a href="https://en.wikipedia.org/wiki/Dirichlet_distribution">Dirichlet</a> because it has two important properties: 1) the values of the vector are between (0,1), and (2) the entries of the vector add to 1.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>### Create a constant variable with the prior probabilities of each rate category at the root.
rate_category_prior ~ dnDirichlet( rep(1,NUM_STATES) )
moves[++mvi] = mvDirichletSimplex(rate_category_prior,tune=true,weight=2)
</code></pre></div></div>

<p><img src="/assets/images/sse_files/gm3.png" alt="" /></p>

<p><em>Figure 5. Graphical modeling of the root for BiSSE model. Root has a Dirichlet distribution that is a function of the number of states of the trait.</em></p>

<p><strong>Sampling bias</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>### Rho is the probability of sampling species at the present
### fix this to 165/450
sampling &lt;- observed_phylogeny.ntips()/450
</code></pre></div></div>
<p><img src="/assets/images/sse_files/gm4.png" alt="" />
<em>Figure 6. Graphical modeling of the sampling bias for BiSSE model. This is simply a fixed node measuring the percentage of lineages not sampled.</em></p>

<h3 id="full-graphical-bisse-model">Full graphical BiSSE model</h3>

<p>As of now you have a series of fixed, stochastic, and deterministic nodes free floating as small pieces of construction blocks.</p>

<p><img src="/assets/images/sse_files/gm5.png" alt="" />
<em>Figure 7. Blocks defining the parameters that we will need for the BiSSE.</em></p>

<p>The connector is a phylogenetic distribution function <code class="highlighter-rouge">dnCDBDP</code>   <strong>the character dependent birth and death process</strong>. It is in this function that we plug diversification rates, transition rates, root frequencies, and sampling to create the full BiSSE or any SSE model.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>####################################################################
# Building the BiSSE Model as discrete character model+ BD process#
###################################################################

### Here is where I tie speciation, extinction, and Q using a Birth-Death with categories
bissemodel ~ dnCDBDP( rootAge= root_age,
speciationRates   = speciation,
extinctionRates   = extinction,
Q                 = rate_matrix,
pi                = rate_category_prior,
rho               = sampling )
</code></pre></div></div>

<p>In graphical representation the BiSSE model then looks like Figure 8.</p>

<p><img src="/assets/images/sse_files/gm6.png" alt="" />
<em>Figure 8. BiSSE in graphical modeling. We connect all our modeling blocks using a phylogenetic probability distribution where diversification, transition rates, and root frequencies can be estimated.</em></p>

<h3 id="performing-statistical-inference-in-revbayes">Performing statistical inference in RevBayes</h3>
<p><strong>Clamping the data</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>### clamp the model with the "observed" tree and states
bissemodel.clamp( observed_phylogeny )
bissemodel.clampCharData( data )
</code></pre></div></div>
<p>In graphical model then we have added two more fixed nodes
<img src="/assets/images/sse_files/gm7.png" alt="" /></p>

<p><em>Figure 9. Clamping observed data. In the graphical model world the deterministic node of the model gets some shading to indicate that data has been clamped.</em></p>

<p><strong>Getting what you want from the MCMC and checking the performance</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#############
# The Model #
#############


### workspace model wrapper ###
mymodel = model(rate_matrix)

### set up the monitors that will output parameter values to file and screen
monitors[++mni] = mnFile(filename="output/BiSSE_pole.trees", printgen=1, bissemodel)
monitors[++mni] = mnModel(filename="output/BiSSE_pole.log", printgen=1)
##This monitor was the one giving me trouble type has to be the same that data, however I'm not hundred percent sure whether tree should be the stochastic tree assigned by the clamp or the observed_phylogeny. Will and Sebastian have different inputs

monitors[++mni] = mnJointConditionalAncestralState(tree=observed_phylogeny, cdbdp=bissemodel, type="NaturalNumbers", printgen=1, withTips=true, withStartStates=false, filename="output/anc_states_BiSSE_pole.log")
monitors[++mni] = mnScreen(printgen=10, q_01, q_10, speciation, extinction)

</code></pre></div></div>
<p><strong>Running the MCMC</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>################
# The Analysis #
################

### workspace mcmc
mymcmc = mcmc(mymodel, monitors, moves, nruns=1, moveschedule="random")

### pre-burnin to tune the proposals 20% of the sample
mymcmc.burnin(generations=200,tuningInterval=50)

### run the MCMC
mymcmc.run(generations=1000)

</code></pre></div></div>
<p>Full RevBayes code  for BiSSE <a href="/assets/docs/bisse.Rev">bisse.Rev</a></p>
<ul>
  <li>BiSSE run after <a href="/assets/docs/BiSSE_pole24.log">24 hours</a></li>
</ul>

<h3 id="results-visualization">Results visualization</h3>
<p>All the <a href="https://www.dropbox.com/sh/ofgr5h1klffp2c3/AAByUJojpMRf9yPt12Prwaa6a?dl=0">results</a> (after 4 days)
Opening log-file in tracer</p>

<h2 id="hidden-state-speciation-and-extinction-model-hisse-and-the-character-independent-model">Hidden state speciation and extinction model (HiSSE) and the character independent model</h2>
<p>Daniel Caetano’s <a href="/assets/docs/SSB_workshop_Caetanolecture2019.pdf">lecture</a></p>

<p>Now we are going to fit the HiSSE model</p>

<p><img src="/assets/images/sse_files/hisse.png" alt="" /></p>

<p><em>Figure 10. HiSSE model representation in most published papers. Trait is assumed be be binary but it is expanded to four states to accomodate hidden trait affecting diversification.  Parameters <script type="math/tex">(\lambda_{0_A}, \lambda_{1_A},\lambda_{0_B}, \lambda_{1_B})</script> are speciation rates link to each of the states, and parameters <script type="math/tex">(\mu_{0_A},\mu_{1_A},\mu_{0_B},\mu_{1_B})</script> are extinction rates. The transition rates <script type="math/tex">(q_{01},q_{10})</script> indicate how often the value of the trait changes, and they could differ within states A and B. The transition rates between hidden states are <script type="math/tex">(\alpha,\beta)</script>.</em></p>

<ul>
  <li>RevBayes code for HiSSE <a href="/assets/docs/hisse.Rev">hisse.Rev</a></li>
</ul>

<p>and the character independent model (CID)</p>

<p><img src="/assets/images/sse_files/cid.png" alt="" /></p>

<p><em>Figure 11. CID model representation in most published papers. Trait is assumed be be binary but it is expanded to four states to accomodate hidden trait affecting diversification.  We assume here that the trait does not have an effect on diversification and it is only the hidden state that can change speciation and extinction. Parameters <script type="math/tex">(\lambda_{A},\lambda_{B})</script> are speciation rates link to each of the states, and parameters <script type="math/tex">(\mu_{A},\mu_{B})</script> are extinction rates. The transition rates <script type="math/tex">(q_{01},q_{10})</script> indicate how often the value of the trait changes, and they could differ within states A and B. The transition rates between hidden states are <script type="math/tex">(\alpha,\beta)</script>.</em></p>

<ul>
  <li>RevBayes code for CID <a href="/assets/docs/cid.Rev">cid.Rev</a></li>
</ul>

<p><strong>Practice</strong>
Find a teammate!
Just like we did with the BiSSE model, please try to parse out the code to figure out the graphical model that RevBayes is constructing for HiSSE and CID.
We will come back together as a group to discuss similarities and differences and discuss the results of each.</p>
<ul>
  <li>Exercise materials <a href="/assets/docs/hisse_exercise.pdf">HiSSE</a> and <a href="/assets/docs/cid_exercise.pdf">CID</a></li>
</ul>

<p><strong>Results</strong></p>
<ul>
  <li>HiSSE run after <a href="/assets/docs/HiSSE_pole24.log">24hours</a></li>
  <li>CID run after <a href="/assets/docs/CID_pole24.log">24 hours</a></li>
  <li>All the <a href="https://www.dropbox.com/sh/r4vkcrobjdv6s0l/AABcCiSK6YGyDKs6_Gpx7rWCa?dl=0">results</a> (after 4 days)</li>
  <li>Visualizations in <a href="/assets/plotdivrates.R">Rcode</a></li>
  <li>Visalizations for <a href="/assets/plotdivrates_solanaceae.R">solanaceae</a></li>
</ul>

<h3 id="key-references">Key References</h3>
<ul>
  <li>
    <p><strong>HiSSE and CID</strong>: Beaulieu, J.M. and O’Meara, B.C., 2016. Detecting hidden diversification shifts in models of trait-dependent speciation and extinction. Systematic biology, 65(4), pp.583-601.<a href="https://academic.oup.com/sysbio/article/65/4/583/1753616">link</a></p>
  </li>
  <li>
    <p><strong>GeoHiSSE</strong>: Caetano, D.S., O’Meara, B.C. and Beaulieu, J.M., 2018. Hidden state models improve state‐dependent diversification approaches, including biogeographical models. Evolution, 72(11), pp.2308-2324.<a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/evo.13602">link</a></p>
  </li>
  <li>
    <p><strong>RevBayes</strong>: Höhna, S., Landis, M.J., Heath, T.A., Boussau, B., Lartillot, N., Moore, B.R., Huelsenbeck, J.P. and Ronquist, F., 2016. RevBayes: Bayesian phylogenetic inference using graphical models and an interactive model-specification language. Systematic biology, 65(4), pp.726-736.<a href="https://academic.oup.com/sysbio/article/65/4/726/1753608">link</a></p>
  </li>
  <li>
    <p><strong>BiSSE</strong>: Maddison WP, Midford PE, Otto SP. Estimating a binary character’s effect on speciation and extinction. Systematic biology. 2007 Oct 1;56(5):701-10.<a href="https://academic.oup.com/sysbio/article/56/5/701/1694265">link</a></p>
  </li>
  <li>
    <p><strong>BiSSE lack of heterogeneity</strong>: Rabosky, D.L. and Goldberg, E.E., 2015. Model inadequacy and mistaken inferences of trait-dependent speciation. Systematic biology, 64(2), pp.340-355.<a href="https://academic.oup.com/sysbio/article/64/2/340/1633695">link</a></p>
  </li>
  <li>
    <p><strong>MuHisse and model selection</strong>: Zenil‐Ferguson, R., Burleigh, J.G., Freyman, W.A., Igić, B., Mayrose, I. and Goldberg, E.E., 2019. Interaction among ploidy, breeding system and lineage diversification. New Phytologist. <a href="/assets/docs/Zenil-Ferguson_et_al-2019-New_Phytologist.pdf">pdf</a> <a href="/assets/docs/Zenil-Ferguson_et_al-2019-New_Phytologist.sup-2.pdf">supp1</a> <a href="assets/docs/Zenil-Ferguson_et_al-2019-New_Phytologist.sup-1.pdf">supp 2</a> <a href="https://github.com/roszenil/solploidy">repository</a></p>
  </li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-12-29T00:00:00-10:00">December 29, 2019</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/portfolio/SDD/" class="pagination--pager" title="
">Previous</a>
    
    
      <a href="/portfolio/index.html" class="pagination--pager" title="
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/roszenil" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> roszenil</a></li>
        
      
        
          <li><a href="https://github.com/roszenil" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Rosana Zenil-Ferguson. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
<script src="/assets/js/main.min.js"></script>
<script src="https://kit.fontawesome.com/4eee35f757.js"></script>










<script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>



  </body>
</html>
